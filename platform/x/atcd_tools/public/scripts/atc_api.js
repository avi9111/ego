// Generated by CoffeeScript 1.11.1
(function() {
  var AtcRestClient, AtcSettings;

  AtcRestClient = function(endpoint) {
    var _add_ending_slash;
    _add_ending_slash = function(string) {
      if (string[string.length - 1] !== "/") {
        string += "/";
      }
      return string;
    };
    this.endpoint = endpoint || "/api/v1/";
    this.endpoint = _add_ending_slash(this.endpoint);
    return this.api_call = function(method, urn, callback, data) {
      urn = _add_ending_slash(urn);
      return $.ajax({
        url: this.endpoint + urn,
        dataType: "json",
        type: method,
        data: data && JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        complete: function(xhr, status) {
          var rc;
          rc = {
            status: xhr.status,
            json: xhr.responseJSON
          };
          if (callback != null) {
            return callback(rc);
          }
        }
      });
    };
  };

  AtcSettings = function() {
    this.defaults = {
      up: {
        rate: null,
        delay: {
          delay: 0,
          jitter: 0,
          correlation: 0
        },
        loss: {
          percentage: 0,
          correlation: 0
        },
        reorder: {
          percentage: 0,
          correlation: 0,
          gap: 0
        },
        corruption: {
          percentage: 0,
          correlation: 0
        },
        iptables_options: Array()
      },
      down: {
        rate: null,
        delay: {
          delay: 0,
          jitter: 0,
          correlation: 0
        },
        loss: {
          percentage: 0,
          correlation: 0
        },
        reorder: {
          percentage: 0,
          correlation: 0,
          gap: 0
        },
        corruption: {
          percentage: 0,
          correlation: 0
        },
        iptables_options: Array()
      }
    };
    this.getDefaultSettings = function() {
      return $.extend(true, {}, this.defaults);
    };
    return this.mergeWithDefaultSettings = function(data) {
      return $.extend(true, {}, this.defaults, data);
    };
  };

  AtcRestClient.prototype.shape = function(callback, data) {
    return this.api_call("POST", "shape", callback, data);
  };

  AtcRestClient.prototype.unshape = function(callback, data) {
    return this.api_call("DELETE", "shape", callback);
  };

  AtcRestClient.prototype.getCurrentShaping = function(callback) {
    return this.api_call("GET", "shape", callback);
  };

  AtcRestClient.prototype.getToken = function(callback) {
    return this.api_call("GET", "token", callback);
  };

  AtcRestClient.prototype.getAuthInfo = function(callback) {
    return this.api_call("GET", "auth", callback);
  };

  AtcRestClient.prototype.updateAuthInfo = function(address, data, callback) {
    return this.api_call("POST", "auth/".concat(address), callback, data);
  };

}).call(this);
